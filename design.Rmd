# Research design and methods {#design-methods}

O1 will answer: a) how individual components of early life conditions compare in
their contributions to T2D risk, b) how subtler forms of adversity (e.g.
parental conflict such as divorce, parental socio-economic deprivation, recent
immigration) contribute to T2D risk, c) whether there is a non-linear relationship
between early life conditions and T2D risk. Early life conditions include but are
not limited to: parental divorce, death of a parent, neighbourhood area
deprivation, parental education, childhood hospital admissions, recent
immigration, and parental health status.

Denmark has a unique system for collecting and storing comprehensive social,
economic, and health outcome (e.g. T2D diagnoses) data on all residents. The
registers date back several decades and are linkable by individual ID with other
data sources (e.g. cohorts, randomised trials). From these databases, I can
obtain detailed data on early life conditions on all residents of Denmark. The
registers I will use are listed in Table 1. Since working with such
massive and diverse data is a monumental task, the Big Data Centre for
Environment and Health (BERTHA), coordinated by Professor Clive Sabel at Aarhus
University, was recently initiated. BERTHA aims to build an infrastructure and
support network for working with, using, and linking the register databases to
other data sources to study a wide variety of exposures and their influence on
health. I 
will be collaborating with BERTHA researchers and the center to assist
me with O1 and O2.

To analyse the register data for O1, I will use a technique known as Lexis
[@Plummer2011a] objects. This allows me to use Poisson regression models to
obtain incidence rates and rate ratios, comparing disease incidence between
people exposed and not exposed to early life adversity. Lexis classes account
for time-dependent factors (e.g. age at first exposure, birth cohort effects). To
determine the contribution of individual early life conditions on risk for T2D
(for a and b), I will run several models with each early life condition as a
determinant. To
determine whether greater adversity or longer duration of adversity leads to
greater risk (i.e. non-linearity) (for c), I will test for non-linearity by
including non-linear and duration terms in the models.

O2 will identify: a) which metabolic pathways contribute the most to adult T2D
risk in people exposed to early life adversity, and b) which of these metabolic
pathways could be effective targets for mitigating risk. For this, I require
data on early life conditions and incident T2D that comes from the Danish
registers, and detailed adult metabolic data (e.g. standard metabolic profile or
metabolomics) that comes from cohorts or randomized trials. Through Denmark's
unique resident identification system, I am able to link these two sources of
data. The main cohort datasets I will use are listed in Table 1 and include the
Diet, Cancer, and Health Next Generations (DCH-NG) study (an extension of the
DCH cohort [@Tjoenneland2007a] and with collaborator Dr. Overvad on the steering
committee), EPIC-InterAct (a portion of the participants were recruited from
Denmark) [@Consortium2011a], and the ADDITION-DK [@Lauritzen2000a] cohort (Dr.
Witte is on the steering committee). The cohorts contain metabolomics data, a
spectrum of fatty acids, inflammatory markers, and standard metabolic variables
(e.g. lipoproteins and triacylglycerides).

The specific steps for O2 are to: 1) link the cohort metabolic data to the
registers; 2) extract and characterise the early life adversity variables; 3)
extract and characterise the disease incidence data; and, 4) use the NetCoupler
algorithm (described in O3) to determine how the entire metabolic profile
measured in mid-adulthood mediates the association between early life adversity
and risk of incident T2D in mid-to-late adulthood. Through this approach, I
can identify the contributions that individual metabolic variables have on T2D
risk and how early life modifies these metabolites. For instance, the results
may indicate that certain lipids, i.e. palmitic acid (16:0) or palmitoleic acid
(16:1 n-7), are higher in those exposed to early life adversity and that these
lipids contribute to a greater disease risk.

There are several ways to analyse high-dimensional metabolic data. For O2, the
approach I will use to answer my question is a form of pathway analysis.
However, there are limitations to most pathway techniques [@Asvatourian2018a],
which I aim to overcome by using a process called causal structure learning
[@Petersen2014a]. The strengths of this method over others are a) the ability to
use high dimensional data without needing to construct an a priori directed
acyclic graph (DAG), b) to estimate the most probable directions of the
pathways, and c) to identify the most likely causal DAG structure given the
data. I initiated
and am collaborating with Dr Clemens Wittenbecher from the German Institute of
Human Nutrition (DIfE) in Potsdam, Germany to generalise and deploy an algorithm
to exploit this process (NetCoupler). Dr Wittenbecher developed the
NetCoupler-algorithm for his research on diet, metabolomics, and incidence of
T2D [@Wittenbecher2017a]. It iterates through multiple possible DAGs to find
whether a set of pathways in a metabolomics network are most likely to have a
causal link with disease incidence.

## General variables

```{r dag, fig.cap="Some possible, hypothetical pathways underlying early life factors and T2D.", fig.align='center', out.width='80%'}
knitr::include_graphics("images/dag.png", dpi = "retina")
```

- Exposure time period:
    - Conception until ~7 years of age

- Specific exposure variables during individual's exposure time period: 
    - Parental socio-economic
        - Household income
        - Educational attainment
        - Parental unemployment
        - Household poverty
        - Social housing
    - Parental health:
        - Death
        - Severe illness (how to define that further?)
        - Severe psychiatric illness
        - Alcohol and drug abuse
    - Maternal:
        - Smoking during pregnancy and breastfeeding
        - Breastfeeding
    - Parental conditions
        - Divorce
        - Separation
        - Single parent
        - Spousal abuse or injuries
        - Number of times moved
    - Emigration
    - Neighbourhood-level:
        - General income/poverty
        - General crime/safety (possible?)
    - Individual:
        - Severe illness or injury
        - Foster care
    - Sibling:
        - Psychiatric illness
        - Severe illness

- Potential exposure indicators:
    - Birthweight
    - Birth length
    - Height at each year
    - Leg length
    - Weight at each year

- Other variables:
    - Year of birth
    - Month of birth
    - Birth order
    - Number of siblings
    - Parental age
    - Ethnicity
    - Sex
    - Medical data from pregnancy, at birth, and in first years
    - Date of birth

- Outcome variable:
    - Age at diabetes diagnosis 
    - Diabetes status at any given time

- Outcome variables: Age at T2D status (incidence of T2D)

- Metabolic variables: 
    - Standard metabolic variables
    - omic variables

The more exact list of variables used is described in {{Data Source}} section.

## Inclusion and exclusion criteria

```{r lexis-diagram, fig.cap="Some possible, hypothetical pathways underlying early life factors and T2D.", fig.align='center', out.width='80%'}
knitr::include_graphics("images/lexis-diagram.svg", dpi = "retina")
```
TODO: Insert Lexis diagram

TODO: Update this

Those born between 1920 and 1965 could hypothetically be included in the diabetes
register for those older than 30 at the time the register was created. This would
represent the "closed cohort".

Those born between 1965 and 1990 could potentially be included in the diabetes
register since its creation and assuming minimum age for T2D is 30 or older.
This cohort and those from the "closed cohort" would both make up the "open cohort".

## Data sources

- Include diagram of different data sources, variables, sample sizes, etc

### Registries

```{r registers_cohorts_table, results='asis', echo=FALSE}
```

Examples of variables contained within registers and cohorts that will be used
in this project
[@Thygesen2011a;@Carstensen2011a;@Pedersen2011a;@Lauritzen2000a;@Consortium2011a;@Tjoenneland2007a].


#### Assessment of variables

#### Complete list of actual variables used

### Cohorts

- Inter99?
- DCH-NG
- DCH
- ADDITION-DK
- EPIC-InterAct DK?

#### Complete list of actual variables used

#### Assessment of variables

## Data storage and security

## Ethical review

## Data processing and analysis

## Pre-analysis processing

- Data cleaning steps
- Plan to publish code for processing

### Data linkage steps

### Loss to follow-up
