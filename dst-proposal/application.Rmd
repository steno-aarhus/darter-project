---
papersize: a4
fontsize: 11pt
output: 
    word_document: default
    pdf_document:
        toc: true
        toc_depth: 3
---

# Project description for DST application

## Autoriseret institution / Authorised institution

Steno Diabetes Center Aarhus (inst. nr. 574)  
Hedeager 3, 2. sal  
8200 Aarhus  
Denmark  

## Projekttitel / Project title

Interplay between diabetes and intergenerational transmission of health determinants over the life course

## Projektbeskrivelse / Project description

The overall aim of this project is to identify the contributions of family and
early life determinants on the development, management, and care of diabetes and
the diseases that may arise following a diabetes diagnosis, under a life-course
framework.

Diabetes is a complex, multi-factorial disease. Its development depends on the
timing and accumulation of exposures throughout the life-course. In addition to
genetic influences, behavioral risk factors and socioeconomic conditions cluster
in families and are passed through generations. For instance, poor childhood
socioeconomic status (SES) can impact final educational attainment, adult SES,
and lifestyle and behavioral characteristics, which ultimately influence an
individual's metabolic capacity to regulate glucose and subsequent risk for
diabetes.

This project will contribute to a broader and deeper understanding of the role
that these factors play with the development and progression of diabetes. For
this purpose, we will apply causal and predictive statistical methods to best
use the data available from the integrated data sources with an overarching goal
to model several potential public health strategies that might impact the
prevention and management of diabetes and the diseases that follow its
diagnosis. 

<!-- A key feature to this project is the integration of external data -->
<!-- sources, such as longitudinal cohort studies, with the register data. -->

## Population / Population

In order to identify familial relations through individuals' life course trajectory,
the population requested covers all individuals, who live or lived in Denmark 
from 1 January 1970 to 31 December 2020 (~8.5 million people). Key requirements are:

- Individuals were born starting from 1970 with available parental linkage. Wherever
  possible, individuals and parental data throughout their early life, childhood, 
  and adulthood.

- Minimum two and up to four-generation family pedigrees in which index individuals
  have linkage to their parents and spouses. Index individuals are defined as those 
  individuals that serve as a reference to identify family relations and which will
  be followed with regards to the outcomes.

## Variabelindhold / Variables included

All variables can be de-identified (direct identification is not needed). The
list of requested variables is found in the tables at the end of the document in 
the Appendix.

```{r setup, include=FALSE}
library(tidyverse)
library(here)
library(glue)
# library(gt)
dst_variables <- read_csv(here("data/dst-registers-with-variables-to-use.csv"))
dst_variables <- dst_variables %>%
    filter(use_in_application == 1) %>% 
    mutate(across(ends_with("year"), str_extract, pattern = "^\\d{4}")) %>% 
    mutate(years = str_c(variable_start_year, "--", variable_end_year)) %>% 
    select(register_id, register_name_dk, variable_name, years)

sds_variables <- read_csv(here("data/sds-registers-with-variables-to-use.csv"))
sds_variables <- sds_variables %>% 
    filter(use_in_application == 1) %>% 
    select(register_name, table_name, variable_name, periode)

random_registers <- read_csv(here("data/random-undocumented.csv")) %>% 
    mutate(years = str_c(start_year, "--", end_year))

authorized_researchers <-
    read_csv(
        here("data/authorized-researchers.csv"),
        col_types = cols(.default = col_character())
    )

knitr::opts_chunk$set(echo = FALSE)
options(knitr.kable.NA = "")
```

Registers requested are:

```{r dst-register-list, results = "asis"}
read_csv(here("data/needed-registers.csv"), col_types = "lddccccc") %>% 
    filter(!is.na(register_id) & owner == "dst" & (!drop | is.na(drop))) %>% 
    mutate(across(where(is.character), ~if_else(is.na(.), "TO UPDATE", .))) %>% 
    glue_data("- {register_id}: {register_name_dk} / {register_name_english}") %>% 
    sort() %>% 
    cat(sep = "\n")
```

<!-- Please also include information on external data or own survey data if such -->
<!-- data is part of the project. In such cases please include approval from the -->
<!-- Danish Protection Agency. -->

## Særligt vedr. lægemiddelsdata / Especially regarding drug data 

<!--
Only to be filled in if the project is to use drug data. Research projects that
must use data from the Medicines Database must be approved by the Danish Health
and Medicines Authority. The approval process takes place via a contact person
in Forskningsservice. Drug data may only be used for the purpose described in
this project setting. If drug data is to be used for other purposes, a renewed
approval from the Danish Health and Medicines Authority is required.
-->

## Offentliggørelse af resultater / Publication of results

Results will be published in open access scientific outlets and presented at
scientific conferences.

## Perspektivering / Perspective

<!-- A description of what knowledge of societal relevance this study can contribute. -->

## Data som ikke kommer fra Danmarks Statistik / Data that doesn't come from DST

Data coming from other sources (e.g. Sundhedsdatastyrelsen):

<!--
List cohorts:

- Diet, Cancer, and Health study. Next Generation Study
- ADDITION, ADDITION-PRO cohort studies
    - Some ideas: Family characteristics and diabetes control.
- Inter99
- CORE Trial (Check your health study. This is a household intervention)
- The Danish National Health survey (2010, 2013 and 2017)
    - See: https://www.danishhealthdata.com/find-health-data/Danskernes-sundhed Data
    administrator: National Institute of Public Health, SDU, application here:
    http://www.danskernessundhed.dk/Spoergeskema
-->
    
```{r non-dst-register-list, results = "asis"}
read_csv(here("data/needed-registers.csv"), col_types = "lddccccc") %>% 
    filter(!is.na(register_id) & owner != "dst" & (!drop | is.na(drop))) %>% 
    mutate(across(where(is.character), ~if_else(is.na(.), "TO UPDATE", .))) %>% 
    glue_data("- {register_id}: {register_name_dk} / {register_name_english}") %>% 
    sort() %>% 
    cat(sep = "\n")
```

## Projekts slutdato / Project's end date

Date of deletion of data: Access to data is requested until December 2030.

## Autoriserede forskere / Authorised scientists

```{r}
knitr::kable(authorized_researchers)
```

# Bilag / Appendix

## List of registers and variables from DST

```{r requested-dst-variable-tables, echo=FALSE, results='asis'}
variable_tables <- dst_variables %>% 
    mutate(register_name = glue("{register_name_dk} ({register_id})")) %>% 
    select(-register_id, -register_name_dk) %>% 
    rename(Variables = variable_name, Years = years) %>% 
    group_split(register_name) 

for (variable_table in variable_tables) {
    register <- unique(variable_table$register_name)
    # Register name as header
    glue("\n\n### {register}\n\n") %>% 
        as.character() %>% 
        cat()
    
    # Variables as table
    variable_table %>% 
        select(-register_name) %>%  
        knitr::kable(caption = str_c(
            "Requested variables from ",
            register
        )) %>% 
        print()
}
```

## List of registers and variables from external sources

```{r requested-non-dst-variable-tables, echo=FALSE, results='asis'}
sds_variable_tables <- sds_variables %>% 
    rename(
        Table = table_name,
        Variables = variable_name, 
        Years = periode
    ) %>% 
    group_split(register_name) 

for (variable_table in sds_variable_tables) {
    register <- unique(variable_table$register_name)
    # Register name as header
    glue("\n\n### {register}\n\n") %>% 
        as.character() %>% 
        cat()
    
    # Variables as table
    variable_table %>% 
        select(-register_name) %>%  
        knitr::kable(caption = str_c(
            "Requested variables from ",
            register
        )) %>% 
        print()
}
```

```{r requested-random-registers-variable-tables, echo=FALSE, results='asis'}
random_variable_tables <- random_registers %>% 
    select(register_name, register_table_name, variable_name, years) %>% 
    rename(
        Table = register_table_name,
        Variables = variable_name, 
        Years = years
    ) %>% 
    group_split(register_name) 

for (variable_table in random_variable_tables) {
    register <- unique(variable_table$register_name)
    # Register name as header
    glue("\n\n### {register}\n\n") %>% 
        as.character() %>% 
        cat()
    
    if (all(is.na(unique(variable_table$Table)))) {
        variable_table <- variable_table %>% 
            select(-Table)
    }
    
    # Variables as table
    variable_table %>% 
        select(-register_name) %>%  
        knitr::kable(caption = str_c(
            "Requested variables from ",
            register
        )) %>% 
        print()
}
```
