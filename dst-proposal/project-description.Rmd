---
output: word_document
---

# Project description for DST application

## Autoriseret institution / Authorised institution

Steno Diabetes Center Aarhus (inst. nr. 574)  
Hedeager 3, 2. sal  
8200 Aarhus  
Denmark  

## Projekttitel / Project title

Transgenerational and life-course factors that influence risk for type 2
diabetes

Interplay between transgenerational and life-course factors with diabetes

## Projektbeskrivelse / Project description

The overall aim of this project is to identify the contributions of family
network and life-course factors on the development,
management, and care of diabetes and diseases following diabetes.

Diabetes is a complex, multi-factorial disease that is influenced
throughout the life-course from individual as well as social factors.
Behavioural risk factors and socioeconomic conditions cluster in families and
their influence depends on the timing and accumulation of exposures. 
For instance, poor childhood socioeconomic status (SES) can impact final 
educational attainment, adult SES, and lifestyle and behavioural
characteristics, which ultimately influences an individual's metabolic capacity
to regulate glucose and subsequent risk for diabetes.

This project will contribute to a broader and deeper understanding of the role
that these factors play with the development and progression of diabetes.
Using the findings from this project we hope to model several potential public
health strategies that could impact the prevention and management of diabetes 
and diseases following diabetes.

A key feature to this project is the integration of external data sources, such
as longitudinal cohort studies, with the register data. We aim to apply causal
and predictive statistical methods to best use the data available from the 
integrated data sources.

TODO: Add simple DAG of expected relationship?

## Population / Population

In order to identify familial relations through individuals’ life course
trajectory, the population requested covers all individuals, alive or deceased,
who live or lived in Denmark from 1 January 1970 to 31 December 2020 (~8.5
million people). Key requirements are:

- Data on parents of those born starting from 1970 as well as data throughout
their early life and childhood.
- Minimum two, and up to four-generation pedigree in which index
individuals have linkage to their parents, siblings, half-siblings, and spouses.
Index individuals are defined as those individuals that serve as a reference to
identify family relations and which will be followed with regards to the
outcome.

## Variabelindhold / Variables included

All variables can be de-identified (direct identification is not needed). List
of requested variables is found in the tables at the end of the document.

<!--
- Befolkning vs. Demografi, familie og husstandsforhold (BEF) 
- BEF_ADRESSELABEL, BEF_PERSONNUMMER, Byopgørelsen, Familier og husstande
- Fertilitetsdatabasen
- Personindkomst vs. Indkomster (INDH/INDK)
- Familieindskomst (FAIK)
- Kvalifikationsregistret vs. Uddannelsesoplysninger (UDDA) 
- Vandringer (VNDS)
- Arbejdsklassifikationsmodulet (AKM)
- Sygesikringsregisteret (SYSI, SSSY)
- Lægemiddelregisteret (LMDB)
- Arbejdsplads(er)

Others?

- Imprisonment.
- Børnetilskud og børnefamilieydelse
- Levevilkårsundersøgelsen (SILC)
- Forbrugsundersøgelsen?
- Idræt?
- BARNFORA? (Henvisninger mellem barn og forældre (references between children
and parents)
- FTDB (Fertilitetsdatabasen)
- LPR-Psikiatri (To extract psichiatryc diseases for the prediction model and
family history)
- LABKA
- Landsdækkende kliniske kvalitetsdatabase for screening af diabetisk retinopati
og maculopati (DiaBase): Diabetes definition
- Cancer register (to identify family history)
- Særligt vedr. Lægemiddelsdata. Der ønskes adgang til lægemidler, da
oplysninger om medicin bidrager til at identificere personer med diabetes og
derudover bidrager til at belyse sygelighed i populationen.

LPR-Psikiatri,  Diabase (retinopathy and maculopathy screening),  Diabetes register? LABKA?

imprisonment.
Børnetilskud og børnefamilieydelse
Levevilkårsundersøgelsen (SILC)
Forbrugsundersøgelsen?
Idræt?

-->

```{r setup, include=FALSE}
library(tidyverse)
library(here)
library(glue)
# library(gt)
dst_variables <- read_csv(here("data/dst-registers-with-variables-to-use.csv"))
dst_variables <- dst_variables %>%
    filter(use_in_application == 1) %>% 
    mutate(across(ends_with("year"), str_extract, pattern = "^\\d{4}")) %>% 
    mutate(years = str_c(variable_start_year, "--", variable_end_year)) %>% 
    select(register_id, register_name_dk, variable_name, years)

authorized_researchers <-
    read_csv(
        here("data/authorized-researchers.csv"),
        col_types = cols(.default = col_character())
    )

knitr::opts_chunk$set(echo = FALSE)
options(knitr.kable.NA = "")
```

Registers requested are:

```{r register-list, results = "asis"}
read_csv(here("data/needed-registers.csv"), col_types = "dccccc") %>% 
    filter(!is.na(register_id)) %>% 
    mutate(across(where(is.character), ~if_else(is.na(.), "TO UPDATE", .))) %>% 
    glue_data("- {register_id}: {register_name_dk} / {register_name_english}") %>% 
    sort() %>% 
    cat(sep = "\n")
```

<!-- Please also include information on external data or own survey data if such -->
<!-- data is part of the project. In such cases please include approval from the -->
<!-- Danish Protection Agency. -->

## Særligt vedr. lægemiddelsdata / Especially regarding drug data 

## Offentliggørelse af resultater / Publication of results

## Perspektivering

## Data som ikke kommer fra Danmarks Statistik / Data that doesn't come from DST

List cohorts:

- Diet, Cancer, and Health study. Next Generation Study
- ADDITION, ADDITION-PRO cohort studies
    - Some ideas: Family characteristics and diabetes control.
- Inter99
- CORE Trial (Check your health study. This is a household intervention)
- The Danish National Health survey (2010, 2013 and 2017)
    - See: https://www.danishhealthdata.com/find-health-data/Danskernes-sundhed Data
    administrator: National Institute of Public Health, SDU, application here:
    http://www.danskernessundhed.dk/Spoergeskema
    
Fra Sundhedsdatastyrelsen vil vi desuden søge om adgang til følgende register
for data om diabetes samt relaterede sygdomme og risikofaktorer:

- Kroniske sygdomsdiagnoser:
- Det Nationale Diabetesregister? (LPR, RMPS, DADD, Diabase)
- Medicinering kronisk sygdom:
- Exposures and risk factors: Overvægt?
- LPR diagnosis of overweight may be included : ICD 10: E66. Maybe possible to
get some data from electronic health records.
- drug addicts in treatment and alcohol treatment registers. Could we use
diagnoses of substance abuse / alcohol abuse: ICD-10: F1x
- children data base

## Projekts slutdato / Project's end date

Date of deletion of data: Access to data is requested until December 2030.

## Autoriserede forskere / Authorised scientists

```{r}
knitr::kable(authorized_researchers)
```

# Bilag / Appendix

## List of registers and variables, with explanations

```{r requested-variable-table, echo=FALSE, results='asis'}
variable_tables<- dst_variables %>% 
    mutate(register_name = glue("{register_name_dk} ({register_id})")) %>% 
    select(-register_id, -register_name_dk) %>% 
    rename(Variables = variable_name, Years = years) %>% 
    group_split(register_name) 

for (variable_table in variable_tables) {
    variable_table %>% 
        select(-register_name) %>%  
        knitr::kable(caption = str_c(
            "Requested variables from ",
            unique(variable_table$register_name)
        )) %>% 
        print()
}
    # gt() %>% 
    # tab_style(
    #     style = cell_text(weight = "bold"),
    #     locations = cells_row_groups()
    # ) %>% 
    # tab_style(
    #     style = cell_text(weight = "bold"),
    #     locations = cells_column_labels(everything())
    # ) %>% 
    # tab_header("Explanation for requested selected variables and registers.") %>% 
    # cols_label(variable_english = "Variable in English", explanation = "Explanation")
```
